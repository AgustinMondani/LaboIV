import{a as A}from"./chunk-B62DE3ON.js";import{a as D}from"./chunk-NSFHJ6NV.js";import{a as F}from"./chunk-2QAIXTRJ.js";import"./chunk-JHHDI4HL.js";import{$a as x,Ab as k,Bb as E,Ca as M,Db as z,F as w,Ga as h,K as y,Na as l,P as S,Pa as a,Qa as o,Ra as O,Ua as b,Va as v,W as p,Wa as d,X as m,_a as u,ab as P,c as j,j as g,ra as I,ta as s,xa as f}from"./chunk-4LKR36O3.js";import"./chunk-LJ5XHLMQ.js";import{h as C}from"./chunk-FK42CRUA.js";var _=class n{constructor(t){this.http=t}apiUrl="https://disneyapi.dev/api/character/";personajesDisponibles=["Mickey Mouse","Donald Duck","Goofy","Pluto","Minnie Mouse","Elsa","Anna","Olaf","Simba","Ariel","Belle","Aladdin"];usados=[];obtenerPreguntaConReintento(t=3){if(this.usados.length>=this.personajesDisponibles.length)return g(null);let e=this.personajesDisponibles.filter(r=>!this.usados.includes(r)),i=e[Math.floor(Math.random()*e.length)];return this.usados.push(i),this.http.get(`${this.apiUrl}?name=${encodeURIComponent(i)}`).pipe(w(r=>{let c=r?.[0];if(!c&&t>0)return this.obtenerPreguntaConReintento(t-1);if(!c)return g(null);let V=[...this.personajesDisponibles.filter(J=>J!==i).sort(()=>Math.random()-.5).slice(0,3),i].sort(()=>Math.random()-.5);return g({imagen:c.imageUrl,opciones:V,correcta:i})}))}obtenerPregunta(){return this.obtenerPreguntaConReintento()}obtenerPreguntas(t=6){this.reiniciarJuego();let e=[];return new j(i=>{let r=()=>{if(e.length>=t){i.next(e),i.complete();return}this.obtenerPregunta().subscribe(c=>{c&&e.push(c),r()},c=>{console.error("Error al obtener pregunta:",c),r()})};r()})}reiniciarJuego(){this.usados=[]}obtenerTotalPreguntas(){return this.personajesDisponibles.length}static \u0275fac=function(e){return new(e||n)(S(D))};static \u0275prov=y({token:n,factory:n.\u0275fac,providedIn:"root"})};function $(n,t){n&1&&(a(0,"div",4)(1,"p"),u(2,"Cargando preguntas..."),o()())}function N(n,t){if(n&1){let e=b();a(0,"button",9),v("click",function(){let r=p(e).$implicit,c=d(2);return m(c.elegir(r))}),u(1),o()}if(n&2){let e=t.$implicit;s(),P(" ",e," ")}}function H(n,t){if(n&1){let e=b();a(0,"div")(1,"p"),u(2),o(),a(3,"button",9),v("click",function(){p(e);let r=d(2);return m(r.siguiente())}),u(4,"Siguiente"),o()()}if(n&2){let e=d(2);s(2),x(e.mensaje)}}function B(n,t){if(n&1&&(a(0,"div")(1,"div",5),O(2,"img",6),a(3,"p"),u(4),o(),a(5,"div",7),h(6,N,2,1,"button",8),o()(),h(7,H,5,1,"div",3),o()),n&2){let e=d();s(2),l("src",e.pregunta==null?null:e.pregunta.imagen,I),s(2),x(e.pregunta==null?null:e.pregunta.correcta),s(2),l("ngForOf",e.pregunta==null?null:e.pregunta.opciones),s(),l("ngIf",e.seleccion)}}function G(n,t){if(n&1){let e=b();a(0,"div")(1,"p"),u(2,"Juego finalizado"),o(),a(3,"p"),u(4),o(),a(5,"button",9),v("click",function(){p(e);let r=d();return m(r.reiniciar())}),u(6,"Reiniciar"),o()()}if(n&2){let e=d();s(4),P("Puntaje final: ",e.puntaje,"")}}var T=class n{constructor(t,e,i){this.preguntadosService=t;this.supabase=e;this.puntuacionService=i}preguntas=[];indicePregunta=0;pregunta;seleccion="";mensaje="";puntaje=0;totalPreguntas=3;respondidas=0;juegoFinalizado=!1;cargando=!1;ngOnInit(){this.iniciarJuego()}iniciarJuego(){this.cargando=!0,this.juegoFinalizado=!1,this.puntaje=0,this.respondidas=0,this.indicePregunta=0,this.seleccion="",this.mensaje="",this.pregunta=null,this.preguntadosService.obtenerPreguntas(this.totalPreguntas).subscribe(t=>{this.preguntas=t,this.preguntas.length>0&&this.mostrarPreguntaActual(),this.cargando=!1},t=>{console.error("Error cargando preguntas",t),this.cargando=!1})}mostrarPreguntaActual(){this.indicePregunta<this.preguntas.length?(this.pregunta=this.preguntas[this.indicePregunta],this.seleccion="",this.mensaje=""):this.finalizarJuego()}elegir(t){!this.pregunta||this.seleccion||(this.seleccion=t,this.respondidas++,t===this.pregunta.correcta?(this.puntaje+=10,this.mensaje="\xA1Correcto!"):this.mensaje=`Incorrecto. La respuesta correcta era: ${this.pregunta.correcta}`)}siguiente(){this.seleccion&&(this.indicePregunta++,this.mostrarPreguntaActual())}reiniciar(){this.iniciarJuego()}finalizarJuego(){return C(this,null,function*(){this.juegoFinalizado=!0;let t=yield this.supabase.getSessionPuntaje(),e=t?.user_metadata?.username??"An\xF3nimo",i=t?.email??"sin@email";yield this.puntuacionService.guardarPuntaje(e,i,"Preguntados",this.puntaje)})}static \u0275fac=function(e){return new(e||n)(f(_),f(F),f(A))};static \u0275cmp=M({type:n,selectors:[["app-preguntados-simpson"]],decls:6,vars:3,consts:[[1,"contenedor-preguntados"],[1,"titulo-juego"],["class","cargando",4,"ngIf"],[4,"ngIf"],[1,"cargando"],[1,"pregunta"],["alt","Imagen de la pregunta",1,"imagen-pregunta",3,"src"],[1,"opciones"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,i){e&1&&(a(0,"div",0)(1,"h1",1),u(2,"Preguntados Disney"),o(),h(3,$,3,0,"div",2)(4,B,8,4,"div",3)(5,G,7,1,"div",3),o()),e&2&&(s(3),l("ngIf",i.cargando),s(),l("ngIf",!i.cargando&&!i.juegoFinalizado),s(),l("ngIf",i.juegoFinalizado))},dependencies:[z,k,E],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:94vh;font-family:Segoe UI,sans-serif;background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);color:#fff;padding:1rem;justify-content:center;align-items:center}.titulo-juego[_ngcontent-%COMP%]{font-size:2rem;text-align:center;color:#00c6ff;text-shadow:0 0 10px rgba(0,198,255,.6)}.contenedor-preguntados[_ngcontent-%COMP%]{background:#ffffff0d;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);border-radius:1.5rem;padding:2rem;max-width:500px;width:100%;box-shadow:0 0 30px #0006;border:1px solid rgba(255,255,255,.1);animation:_ngcontent-%COMP%_fadeIn .5s ease;display:flex;flex-direction:column;align-items:center;gap:1.2rem}.imagen-pregunta[_ngcontent-%COMP%]{display:block;margin:0 auto}img[_ngcontent-%COMP%]{min-height:50dvh;max-height:50dvh;min-width:15dvw;max-width:15dvw;background-color:#fff;border-radius:50px;box-shadow:0 0 30px #01c6ff99}button[_ngcontent-%COMP%]{padding:.8rem 1.5rem;border:none;border-radius:1rem;font-weight:700;cursor:pointer;font-size:1rem;transition:all .3s ease;box-shadow:0 0 10px #00c6ff66;color:#fff;background:linear-gradient(145deg,#00c6ff,#0072ff);width:100%;margin:.3rem 0}button[_ngcontent-%COMP%]:hover{background:linear-gradient(145deg,#009ee0,#05a);transform:scale(1.05)}button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.correcto[_ngcontent-%COMP%]{background:linear-gradient(145deg,#28a745,#218838)!important;box-shadow:0 0 15px #28a74599}.incorrecto[_ngcontent-%COMP%]{background:linear-gradient(145deg,#dc3545,#c82333)!important;box-shadow:0 0 15px #dc354599}p[_ngcontent-%COMP%]{font-size:1.1rem;text-shadow:0 0 5px rgba(255,255,255,.2);text-align:center}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.encabezado[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;width:100%;margin-bottom:1rem}"]})};export{T as PreguntadosComponent};
