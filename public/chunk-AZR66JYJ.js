import{a as J}from"./chunk-KFRWHCPZ.js";import{a as V}from"./chunk-4MG6F2KI.js";import{a as N}from"./chunk-DKCYHLKT.js";import"./chunk-JHHDI4HL.js";import{Ba as O,Bb as T,F as C,Fa as b,K as y,Ma as p,Oa as a,P as M,Pa as s,Qa as k,Ra as v,Sa as P,Ta as g,W as m,X as f,Xa as d,Za as F,_a as j,c as x,eb as A,j as l,n as S,qa as I,sa as c,wa as h,xb as E,yb as z,zb as D}from"./chunk-2JO26CHD.js";import"./chunk-LJ5XHLMQ.js";import{h as w}from"./chunk-FK42CRUA.js";var _=class i{constructor(t){this.http=t}urlApi="https://thesimpsonsquoteapi.glitch.me/quotes?count=1";personajesDisponibles=["Homer Simpson","Marge Simpson","Bart Simpson","Lisa Simpson","Mr. Burns","Milhouse Van Houten","Ned Flanders","Krusty the Clown","Chief Wiggum","Ralph Wiggum","Moe Szyslak","Apu Nahasapeemapetilon"];usados=[];obtenerPregunta(){return this.usados.length>=this.personajesDisponibles.length?l(null):this.http.get(this.urlApi).pipe(S(t=>{let e=t[0],n=e.character;if(!this.personajesDisponibles.includes(n)||this.usados.includes(n))return this.obtenerPregunta();this.usados.push(n);let u=[...this.personajesDisponibles.filter(o=>o!==n).sort(()=>Math.random()-.5).slice(0,3),n].sort(()=>Math.random()-.5);return{imagen:e.image,opciones:u,correcta:n}}),C(t=>t instanceof x?t:l(t)))}obtenerPreguntas(t=6){this.reiniciarJuego();let e=[],n=()=>this.http.get(this.urlApi).pipe(C(r=>{let u=r[0],o=u.character;if(!this.personajesDisponibles.includes(o)||this.usados.includes(o))return n();this.usados.push(o);let R=[...this.personajesDisponibles.filter($=>$!==o).sort(()=>Math.random()-.5).slice(0,3),o].sort(()=>Math.random()-.5),U={imagen:u.image,opciones:R,correcta:o};return l(U)}));return new x(r=>{let u=()=>{if(e.length>=t){r.next(e),r.complete();return}n().subscribe(o=>{e.push(o),u()},o=>r.error(o))};u()})}reiniciarJuego(){this.usados=[]}obtenerTotalPreguntas(){return this.personajesDisponibles.length}static \u0275fac=function(e){return new(e||i)(M(V))};static \u0275prov=y({token:i,factory:i.\u0275fac,providedIn:"root"})};var L=(i,t)=>({correcto:i,incorrecto:t});function W(i,t){i&1&&(a(0,"h2",4),d(1,"PREGUNTADOS"),s())}function G(i,t){i&1&&(a(0,"div")(1,"p",4),d(2,"Cargando preguntas..."),s()())}function K(i,t){if(i&1){let e=v();a(0,"button",12),P("click",function(){let r=m(e).$implicit,u=g(2);return f(u.elegir(r))}),d(1),s()}if(i&2){let e=t.$implicit,n=g(2);p("disabled",n.seleccion!=="")("ngClass",A(3,L,e===n.pregunta.correcta&&n.seleccion!=="",e===n.seleccion&&e!==n.pregunta.correcta)),c(),F(" ",e," ")}}function Q(i,t){if(i&1){let e=v();a(0,"div",5),k(1,"img",6),a(2,"div",7)(3,"p",8),d(4),s()(),a(5,"div",9),b(6,K,2,6,"button",10),s(),a(7,"button",11),P("click",function(){m(e);let r=g();return f(r.siguiente())}),d(8," Siguiente "),s()()}if(i&2){let e=g();c(),p("src",e.pregunta.imagen,I),c(3),j("Puntaje: ",e.puntaje," / ",e.totalPreguntas,""),c(2),p("ngForOf",e.pregunta.opciones),c(),p("disabled",!e.seleccion)}}function X(i,t){if(i&1){let e=v();a(0,"div",5)(1,"h2",13),d(2,"Juego terminado"),s(),a(3,"p",13),d(4),s(),a(5,"button",14),P("click",function(){m(e);let r=g();return f(r.reiniciar())}),d(6,"Jugar de nuevo"),s()()}if(i&2){let e=g();c(4),j("Respondiste ",e.puntaje," preguntas correctas de ",e.totalPreguntas,"")}}var H=class i{constructor(t,e,n){this.preguntadosService=t;this.supabase=e;this.puntuacionService=n}preguntas=[];indicePregunta=0;pregunta;seleccion="";mensaje="";puntaje=0;totalPreguntas=3;respondidas=0;juegoFinalizado=!1;cargando=!1;ngOnInit(){this.iniciarJuego()}iniciarJuego(){this.cargando=!0,this.juegoFinalizado=!1,this.puntaje=0,this.respondidas=0,this.indicePregunta=0,this.seleccion="",this.mensaje="",this.preguntadosService.obtenerPreguntas(this.totalPreguntas).subscribe(t=>{this.preguntas=t,this.mostrarPreguntaActual(),this.cargando=!1},t=>{console.error("Error cargando preguntas",t),this.cargando=!1})}mostrarPreguntaActual(){return w(this,null,function*(){if(this.indicePregunta<this.totalPreguntas)this.pregunta=this.preguntas[this.indicePregunta],this.seleccion="",this.mensaje="";else{let t=yield this.supabase.getSessionPuntaje(),e=t?.user_metadata?.username??"An\xF3nimo",n=t?.email??"sin@email";yield this.puntuacionService.guardarPuntaje(e,n,"Preguntados",this.puntaje),this.juegoFinalizado=!0}})}elegir(t){!this.pregunta||this.seleccion||(this.seleccion=t,this.respondidas++,t===this.pregunta.correcta?(this.puntaje+=10,this.mensaje="\xA1Correcto!"):this.mensaje=`Incorrecto. La respuesta correcta era: ${this.pregunta.correcta}`)}siguiente(){this.seleccion&&(this.indicePregunta++,this.mostrarPreguntaActual())}reiniciar(){this.iniciarJuego()}static \u0275fac=function(e){return new(e||i)(h(_),h(N),h(J))};static \u0275cmp=O({type:i,selectors:[["app-preguntados-simpson"]],decls:5,vars:4,consts:[["class","titulo-juego",4,"ngIf"],[1,"contenedor-juego"],[4,"ngIf"],["class","seccion-juego",4,"ngIf"],[1,"titulo-juego"],[1,"seccion-juego"],["star","","alt","Personaje",1,"imagen-pregunta",3,"src"],[1,"imagen-pregunta"],[1,"puntaje"],[1,"opciones-grid"],["class","boton-opcion",3,"disabled","ngClass","click",4,"ngFor","ngForOf"],[1,"boton","boton-reiniciar",3,"click","disabled"],[1,"boton-opcion",3,"click","disabled","ngClass"],[1,"resultado"],[1,"boton","boton-reiniciar",3,"click"]],template:function(e,n){e&1&&(b(0,W,2,0,"h2",0),a(1,"div",1),b(2,G,3,0,"div",2)(3,Q,9,5,"div",3)(4,X,7,2,"div",3),s()),e&2&&(p("ngIf",!n.cargando),c(2),p("ngIf",n.cargando),c(),p("ngIf",!n.cargando&&!n.juegoFinalizado&&n.pregunta),c(),p("ngIf",n.juegoFinalizado))},dependencies:[T,E,z,D],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:94vh;font-family:Segoe UI,sans-serif;background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);color:#fff;padding:1rem;justify-content:center;align-items:center}.titulo-juego[_ngcontent-%COMP%]{font-size:2rem;text-align:center;color:#00c6ff;text-shadow:0 0 10px rgba(0,198,255,.6)}.contenedor-preguntados[_ngcontent-%COMP%]{background:#ffffff0d;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);border-radius:1.5rem;padding:2rem;max-width:500px;width:100%;box-shadow:0 0 30px #0006;border:1px solid rgba(255,255,255,.1);animation:_ngcontent-%COMP%_fadeIn .5s ease;display:flex;flex-direction:column;align-items:center;gap:1.2rem}.imagen-pregunta[_ngcontent-%COMP%]{display:block;margin:0 auto}img[_ngcontent-%COMP%]{min-height:50dvh;max-height:50dvh;min-width:15dvw;max-width:15dvw;background-color:#fff;border-radius:50px;box-shadow:0 0 30px #01c6ff99}button[_ngcontent-%COMP%]{padding:.8rem 1.5rem;border:none;border-radius:1rem;font-weight:700;cursor:pointer;font-size:1rem;transition:all .3s ease;box-shadow:0 0 10px #00c6ff66;color:#fff;background:linear-gradient(145deg,#00c6ff,#0072ff);width:100%;margin:.3rem 0}button[_ngcontent-%COMP%]:hover{background:linear-gradient(145deg,#009ee0,#05a);transform:scale(1.05)}button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.correcto[_ngcontent-%COMP%]{background:linear-gradient(145deg,#28a745,#218838)!important;box-shadow:0 0 15px #28a74599}.incorrecto[_ngcontent-%COMP%]{background:linear-gradient(145deg,#dc3545,#c82333)!important;box-shadow:0 0 15px #dc354599}p[_ngcontent-%COMP%]{font-size:1.1rem;text-shadow:0 0 5px rgba(255,255,255,.2);text-align:center}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.encabezado[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;width:100%;margin-bottom:1rem}"]})};export{H as PreguntadosComponent};
