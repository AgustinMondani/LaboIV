import{u as F}from"./chunk-VFF2UD4S.js";import{a as A}from"./chunk-4VNXVQXX.js";import{a as N}from"./chunk-3O7R6LMN.js";import"./chunk-JHHDI4HL.js";import{$a as P,Ab as S,Ba as O,Cb as I,Fa as d,Ma as l,Oa as s,Pa as o,Qa as _,Ra as b,Sa as v,Ta as C,Ua as x,Va as g,W as f,X as u,Za as m,_a as j,sa as r,wa as h,yb as w,zb as k}from"./chunk-OBJE3FPQ.js";import"./chunk-LJ5XHLMQ.js";import{h as M}from"./chunk-FK42CRUA.js";function B(n,e){n&1&&(b(0),_(1,"img",9),v())}function T(n,e){if(n&1&&(b(0),_(1,"div",10),s(2,"span",11),m(3),o(),v()),n&2){let t=g().$implicit;r(3),j(t.split("-")[1])}}function V(n,e){if(n&1){let t=C();s(0,"div",7),x("click",function(){let i=f(t).index,c=g().index,p=g();return u(p.disparar(c,i))}),d(1,B,2,0,"ng-container",8)(2,T,4,1,"ng-container",8),o()}if(n&2){let t=e.$implicit;l("ngClass",t.startsWith("hit")?"hit":t.startsWith("miss")?"miss":""),r(),l("ngIf",t==="hit"),r(),l("ngIf",t.startsWith("miss"))}}function D(n,e){if(n&1&&(s(0,"div",5),d(1,V,3,3,"div",6),o()),n&2){let t=e.$implicit;r(),l("ngForOf",t)}}function J(n,e){if(n&1){let t=C();s(0,"button",12),x("click",function(){f(t);let i=g();return u(i.reiniciar())}),m(1,"Reiniciar"),o()}}var E=class n{constructor(e,t){this.puntuacionService=e;this.supabase=t}tablero=[];barcos=new Set;intentos=8;aciertos=0;juegoFinalizado=!1;mensaje="";usuario;ngOnInit(){this.iniciarJuego()}iniciarJuego(){for(this.tablero=Array.from({length:6},()=>Array(6).fill("")),this.barcos.clear(),this.intentos=8,this.aciertos=0,this.juegoFinalizado=!1,this.mensaje="";this.barcos.size<7;){let t=Math.floor(Math.random()*6),a=Math.floor(Math.random()*6);this.barcos.add(`${t},${a}`)}let e=Array.from({length:6},(t,a)=>Array.from({length:6},(i,c)=>this.barcos.has(`${a},${c}`)?"\u{1F6A2}":"\u{1F30A}"));console.table(e)}disparar(e,t){if(this.juegoFinalizado||this.tablero[e][t]!=="")return;let a=`${e},${t}`;if(this.barcos.has(a))this.tablero[e][t]="hit",this.aciertos++,this.mensaje="\xA1Tocado!";else{let c=1/0;this.barcos.forEach(p=>{let[$,z]=p.split(",").map(Number),y=Math.abs(e-$)+Math.abs(t-z);y<c&&(c=y)}),this.tablero[e][t]=`miss-${c}`,this.mensaje=`\xA1Agua! El barco m\xE1s cercano est\xE1 a ${c} casillas`,this.intentos--}let i=0;this.aciertos===7?(this.juegoFinalizado=!0,i=this.intentos*10+100,this.mensaje=`\xA1Ganaste! Puntaje: ${i}`,this.guardarPuntuacion(i)):this.intentos===0&&(this.juegoFinalizado=!0,i=this.aciertos*5,this.mensaje=`\xA1Perdiste! Puntaje: ${i}`,this.guardarPuntuacion(i))}guardarPuntuacion(e){return M(this,null,function*(){let t=yield this.supabase.getSessionPuntaje(),a=t?.user_metadata?.username??"An\xF3nimo",i=t?.email??"sin@email";yield this.puntuacionService.guardarPuntaje(a,i,"Naval",e)})}reiniciar(){this.iniciarJuego()}static \u0275fac=function(t){return new(t||n)(h(A),h(N))};static \u0275cmp=O({type:n,selectors:[["app-batalla-naval"]],decls:10,vars:4,consts:[[1,"titulo"],[1,"tablero"],["class","fila",4,"ngFor","ngForOf"],[1,"info","juego"],[3,"click",4,"ngIf"],[1,"fila"],["class","celda",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"celda",3,"click","ngClass"],[4,"ngIf"],["src","https://dnajbskfruaklvmnchzv.supabase.co/storage/v1/object/public/assets/bote.svg",1,"barco"],[1,"splash"],[1,"distancia"],[3,"click"]],template:function(t,a){t&1&&(s(0,"h2",0),m(1,"Batalla Naval"),o(),s(2,"div",1),d(3,D,2,1,"div",2),o(),s(4,"div",3)(5,"p"),m(6),o(),s(7,"p"),m(8),o(),d(9,J,2,0,"button",4),o()),t&2&&(r(3),l("ngForOf",a.tablero),r(3),P("Intentos restantes: ",a.intentos,""),r(2),P("Aciertos: ",a.aciertos,"/7"),r(),l("ngIf",a.juegoFinalizado))},dependencies:[F,I,w,k,S],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;min-height:94vh;font-family:Segoe UI,sans-serif;background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);color:#fff;padding:2rem}.titulo[_ngcontent-%COMP%]{margin-top:2rem;font-size:2.5rem;text-align:center;color:#00c6ff;text-shadow:0 0 15px rgba(0,198,255,.7)}.tablero[_ngcontent-%COMP%]{display:grid;grid-template-rows:repeat(6,1fr);gap:12px;margin-top:3rem}.fila[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(6,1fr);gap:12px}.celda[_ngcontent-%COMP%]{width:70px;height:70px;border:2px solid #00c6ff;border-radius:12px;background:#ffffff0d;cursor:pointer;display:flex;align-items:center;justify-content:center;position:relative;transition:transform .2s ease,box-shadow .2s ease,background .3s ease}.celda[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 0 10px #00c6ff80}.celda.hit[_ngcontent-%COMP%]{background:linear-gradient(145deg,#ff416c,#ff4b2b);animation:_ngcontent-%COMP%_explode .4s ease-out}.celda.miss[_ngcontent-%COMP%]{background:linear-gradient(145deg,#00c6ff,#0072ff);animation:_ngcontent-%COMP%_splashAnim .5s ease-out}@keyframes _ngcontent-%COMP%_explode{0%{transform:scale(.5) rotate(-10deg);opacity:0}to{transform:scale(1) rotate(0);opacity:1}}@keyframes _ngcontent-%COMP%_splashAnim{0%{transform:scale(.2);opacity:.8}to{transform:scale(1.4);opacity:0}}.barco[_ngcontent-%COMP%]{width:50px;height:50px;transition:transform .3s ease;filter:drop-shadow(0 0 5px rgba(0,198,255,.7));animation:_ngcontent-%COMP%_barcoAnim .5s ease-out}@keyframes _ngcontent-%COMP%_barcoAnim{0%{transform:scale(0) rotate(-20deg);opacity:0}to{transform:scale(1) rotate(0);opacity:1}}.distancia[_ngcontent-%COMP%]{position:absolute;color:#fff;font-size:1.6rem;font-weight:700;text-shadow:0 0 5px rgba(0,0,0,.7);pointer-events:none}.info[_ngcontent-%COMP%]{margin-top:2rem;text-align:center;font-size:1.2rem;font-weight:700;text-shadow:0 0 10px rgba(0,198,255,.7)}.barra-progreso[_ngcontent-%COMP%]{width:100%;height:12px;background:#ffffff1a;border-radius:6px;margin:1rem 0;display:flex}.aciertos[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#28a745,#218838);transition:width .3s ease}.intentos[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#dc3545,#c82333);transition:width .3s ease}.juego[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:20px;align-self:center;background:#00ffae;color:#000;padding:.6rem 1.4rem;border-radius:.6rem;border:none;font-weight:700;cursor:pointer;transition:background .3s ease,transform .2s ease}.juego[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#00c68a;transform:scale(1.05)}']})};export{E as BatallaNavalComponent};
