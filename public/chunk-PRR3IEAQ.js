import{a as E}from"./chunk-4VNXVQXX.js";import{a as k,c as z}from"./chunk-ETUTCWQS.js";import{a as T}from"./chunk-3O7R6LMN.js";import"./chunk-JHHDI4HL.js";import{$a as h,Ab as S,Ba as w,Cb as y,Fa as g,K as C,Ma as l,Na as O,Oa as i,P as v,Pa as r,Qa as M,Ta as f,Ua as b,Va as p,W as d,X as m,Za as s,_a as _,qa as P,sa as a,wa as u,zb as I}from"./chunk-OBJE3FPQ.js";import"./chunk-LJ5XHLMQ.js";import{h as j}from"./chunk-FK42CRUA.js";var x=class n{constructor(t){this.http=t}apiUrl="https://rickandmortyapi.com/api/character";obtenerPersonajes(){return this.http.get(this.apiUrl)}static \u0275fac=function(e){return new(e||n)(v(k))};static \u0275prov=C({token:n,factory:n.\u0275fac,providedIn:"root"})};function J(n,t){if(n&1){let e=f();i(0,"div",5)(1,"button",6),b("click",function(){d(e);let c=p();return m(c.comenzarJuego())}),s(2,"COMENZAR"),r()()}}function A(n,t){if(n&1){let e=f();i(0,"button",16),b("click",function(){let c=d(e).$implicit,U=p(3);return m(U.seleccionarOpcion(c))}),s(1),r()}if(n&2){let e=t.$implicit,o=p(3);O("correcto",o.opcionSeleccionada&&e===o.opcionCorrecta)("incorrecto",o.opcionSeleccionada===e&&e!==o.opcionCorrecta),l("disabled",o.opcionSeleccionada!==null),a(),h(" ",e," ")}}function D(n,t){if(n&1&&(i(0,"div",12),M(1,"img",13),i(2,"div",14),g(3,A,2,6,"button",15),r()()),n&2){let e=p(2);a(),l("src",e.personajeCorrecto.image,P),a(2),l("ngForOf",e.opciones)}}function N(n,t){if(n&1&&(i(0,"div",7)(1,"p",8),s(2),r(),i(3,"p",9),s(4),r(),g(5,D,4,2,"div",10),i(6,"p",11),s(7),r()()),n&2){let e=p();a(2),h("\u23F1 Tiempo restante: ",e.tiempoRestante,"s"),a(2),h("Puntaje: ",e.puntaje,""),a(),l("ngIf",e.personajeCorrecto),a(2),_(e.mensaje)}}function H(n,t){if(n&1){let e=f();i(0,"div",17)(1,"h3"),s(2,"\u23F1 Tiempo terminado"),r(),i(3,"p"),s(4,"Puntaje final: "),i(5,"strong"),s(6),r()(),i(7,"button",6),b("click",function(){d(e);let c=p();return m(c.reiniciarJuego())}),s(8,"REINICIAR"),r()()}if(n&2){let e=p();a(6),_(e.puntaje)}}var R=class n{constructor(t,e,o){this.rmService=t;this.supabase=e;this.puntuacionService=o}personajeCorrecto=null;opciones=[];puntaje=0;mensaje="";juegoIniciado=!1;juegoTerminado=!1;tiempoRestante=30;temporizador;opcionSeleccionada=null;opcionCorrecta=null;todosPersonajes=[];personajesUsados=new Set;ngOnInit(){}ngOnDestroy(){clearInterval(this.temporizador)}comenzarJuego(){this.juegoIniciado=!0,this.juegoTerminado=!1,this.puntaje=0,this.tiempoRestante=30,this.personajesUsados.clear(),this.rmService.obtenerPersonajes().subscribe(t=>{this.todosPersonajes=t.results,this.cargarPregunta()}),this.temporizador=setInterval(()=>{this.tiempoRestante--,this.tiempoRestante<=0&&this.finalizarJuego()},1e3)}cargarPregunta(){this.mensaje="",this.opcionSeleccionada=null,this.opcionCorrecta=null;let t=this.todosPersonajes.filter(c=>!this.personajesUsados.has(c.id));if(t.length===0){this.finalizarJuego();return}let e=Math.floor(Math.random()*t.length);this.personajeCorrecto=t[e],this.personajesUsados.add(this.personajeCorrecto.id);let o=t.filter(c=>c.id!==this.personajeCorrecto.id).sort(()=>.5-Math.random()).slice(0,3);this.opciones=[this.personajeCorrecto.name,...o.map(c=>c.name)].sort(()=>.5-Math.random())}seleccionarOpcion(t){this.juegoTerminado||this.opcionSeleccionada||(this.opcionSeleccionada=t,this.opcionCorrecta=this.personajeCorrecto?.name??null,t===this.personajeCorrecto?.name?this.puntaje+=10:this.puntaje>=3&&(this.puntaje-=3),setTimeout(()=>this.cargarPregunta(),1e3))}finalizarJuego(){return j(this,null,function*(){clearInterval(this.temporizador),this.juegoTerminado=!0;let t=yield this.supabase.getSessionPuntaje(),e=t?.user_metadata?.username??"An\xF3nimo",o=t?.email??"sin@email";yield this.puntuacionService.guardarPuntaje(e,o,"Preguntados",this.puntaje)})}reiniciarJuego(){this.juegoIniciado=!1,this.juegoTerminado=!1,this.puntaje=0,this.tiempoRestante=30,this.personajesUsados.clear()}static \u0275fac=function(e){return new(e||n)(u(x),u(T),u(E))};static \u0275cmp=w({type:n,selectors:[["app-preguntados"]],decls:8,vars:3,consts:[[1,"contenedor-juego","contenedor-preguntados"],[1,"titulo-juego"],["class","pantalla-inicio",4,"ngIf"],["class","pantalla-juego",4,"ngIf"],["class","pantalla-final",4,"ngIf"],[1,"pantalla-inicio"],[3,"click"],[1,"pantalla-juego"],[1,"timer"],[1,"puntaje"],["class","contenedor-imagen",4,"ngIf"],[1,"mensaje"],[1,"contenedor-imagen"],["alt","Personaje",1,"imagen-personaje",3,"src"],[1,"opciones"],[3,"disabled","correcto","incorrecto","click",4,"ngFor","ngForOf"],[3,"click","disabled"],[1,"pantalla-final"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"h2",1),s(2,"Preguntados"),r(),i(3,"h2",1),s(4,"Rick and Morty"),r(),g(5,J,3,0,"div",2)(6,N,8,4,"div",3)(7,H,9,1,"div",4),r()),e&2&&(a(5),l("ngIf",!o.juegoIniciado&&!o.juegoTerminado),a(),l("ngIf",o.juegoIniciado&&!o.juegoTerminado),a(),l("ngIf",o.juegoTerminado))},dependencies:[y,I,S,z],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;min-height:94vh;font-family:Segoe UI,sans-serif;background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);color:#fff;padding:1rem;box-sizing:border-box}.contenedor-juego[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background:#ffffff0d;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);border-radius:1.5rem;padding:2rem;margin:0 auto;max-width:500px;width:100%;height:auto;box-shadow:0 0 30px #0006;border:1px solid rgba(255,255,255,.1);animation:_ngcontent-%COMP%_fadeIn .5s ease;box-sizing:border-box}.titulo-juego[_ngcontent-%COMP%]{font-size:clamp(1.5rem,4vw,2rem);margin-bottom:.5rem;text-align:center;color:#00c6ff;text-shadow:0 0 10px rgba(0,198,255,.6);letter-spacing:2px}.imagen-personaje[_ngcontent-%COMP%]{display:block;margin:0 auto 1rem;width:100%;max-width:280px;height:auto;border-radius:1rem;box-shadow:0 0 40px #01c6ffcc;border:3px solid rgba(0,198,255,.4);transition:transform .3s ease}button[_ngcontent-%COMP%]{padding:.6rem 1rem;border:none;border-radius:1rem;font-weight:700;cursor:pointer;font-size:clamp(.9rem,2vw,1rem);transition:all .3s ease;box-shadow:0 0 10px #00c6ff66;color:#fff;background:linear-gradient(145deg,#00c6ff,#0072ff);width:100%;margin:.4rem 0;box-sizing:border-box}button[_ngcontent-%COMP%]:hover{background:linear-gradient(145deg,#009ee0,#05a);transform:scale(1.05)}button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.opciones[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:.7rem}.opciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:clamp(.95rem,2vw,1.1rem);border-radius:.8rem;padding:.7rem;background:none;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);border:2px solid rgba(0,198,255,.3);color:#fff;transition:all .3s ease;width:100%;box-sizing:border-box}.opciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:not(:disabled):hover{background:#00c6ff33;transform:scale(1.05)}.correcto[_ngcontent-%COMP%]{background:linear-gradient(145deg,#28a745,#218838)!important;box-shadow:0 0 15px #28a745b3}.incorrecto[_ngcontent-%COMP%]{background:linear-gradient(145deg,#dc3545,#c82333)!important;box-shadow:0 0 15px #dc3545b3}.timer[_ngcontent-%COMP%], .puntaje[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:1rem;font-weight:700;text-align:center;min-width:120px;font-size:clamp(.9rem,2vw,1rem)}.timer[_ngcontent-%COMP%]{color:#fc0;text-shadow:0 0 10px rgba(255,204,0,.7)}.puntaje[_ngcontent-%COMP%]{color:#00ffae;text-shadow:0 0 10px rgba(0,255,174,.7)}.pantalla-final[_ngcontent-%COMP%]{text-align:center;animation:_ngcontent-%COMP%_fadeIn .5s ease}.pantalla-final[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:clamp(1.2rem,3vw,1.5rem);margin-bottom:1rem;color:#f55;text-shadow:0 0 12px rgba(255,85,85,.8)}.pantalla-final[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:clamp(1rem,2.5vw,1.2rem);margin-bottom:1rem;color:#fff}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}@media (max-width: 400px){.contenedor-juego[_ngcontent-%COMP%]{padding:1rem}.imagen-personaje[_ngcontent-%COMP%]{max-width:220px}.opciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.9rem;padding:.5rem}}"]})};export{R as PreguntadosComponent};
